!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}({1:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const a=e=>parent.postMessage({pluginMessage:e},"*"),r={IN_PROGRESS:"in-progress",READY_FOR_REVIEW:"ready-for-review",DONE:"done"},i={[r.IN_PROGRESS]:{r:.0823529411764706,g:.3725490196078431,b:.803921568627451},[r.READY_FOR_REVIEW]:{r:1,g:.5,b:0},[r.DONE]:{r:.08235,g:.80392,b:.15294}},o={[r.IN_PROGRESS]:"In progress",[r.READY_FOR_REVIEW]:"Ready for review",[r.DONE]:"Done"}},13:function(e,t,n){"use strict";n.r(t);var a=n(1),r=function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))};figma.showUI(__html__,{height:400,width:400});let i=[];function o(){let e=figma.currentPage.getPluginData("statuses");return e?JSON.parse(e):{}}function s(e){if(1!==e.length)return 0;let t=figma.currentPage.getPluginData(`stories.${e[0].id}`)||[];return"string"==typeof t?JSON.parse(t):[]}setInterval(()=>{!function(){if(i.map(e=>e.id).join(",")===figma.currentPage.selection.map(e=>e.id).join(","))return;const e=o(),t=figma.currentPage.selection.map(t=>({id:t.id,status:e[t.id]}));figma.ui.postMessage({type:"selection-change",payload:{selectedFrames:t,stories:s(figma.currentPage.selection)}}),i=figma.currentPage.selection}()},50),figma.ui.onmessage=e=>{switch(e.type){case"ready":return function(){const e=o(),t=figma.currentPage.selection.map(t=>({id:t.id,status:e[t.id]}));figma.ui.postMessage({type:"selection-change",payload:{selectedFrames:t,stories:s(figma.currentPage.selection)}}),i=figma.currentPage.selection}();case"update-frame-status":return function(e){return r(this,void 0,void 0,(function*(){yield figma.loadFontAsync({family:"Roboto",style:"Black"});const t=function(){const e=figma.currentPage.getPluginData("statusFrameId");let t=figma.currentPage.findOne(t=>t.id===e);t||((t=figma.createFrame()).name="# Statuses",t.clipsContent=!1,t.x=0,t.y=0,t.resizeWithoutConstraints(1,1),figma.currentPage.appendChild(t),figma.currentPage.setPluginData("statusFrameId",t.id));return t}();let n=figma.currentPage.getPluginData("statuses");n=n?JSON.parse(n):{},i.forEach(r=>{if(""===e.payload&&n[r.id]){const e=figma.currentPage.findOne(e=>e.id===n[r.id].frameId);return e&&e.remove(),void delete n[r.id]}let i;if(n[r.id]&&n[r.id]&&(i=figma.currentPage.findOne(e=>e.id===n[r.id].frameId)),(i=i||figma.createFrame()).name=" ",i.x=r.x+r.width-200,i.y=r.y-40-10,i.resizeWithoutConstraints(200,40),i.backgrounds=[{type:"SOLID",color:a.a[e.payload]}],0===i.children.length){const t=figma.createText();t.fontName={family:"Roboto",style:"Black"},t.fontSize=12,t.fills=[{type:"SOLID",color:{r:1,g:1,b:1}}],t.textAlignHorizontal="LEFT",t.textAlignVertical="CENTER",t.characters=a.c[e.payload],t.textCase="UPPER",t.x=32,t.y=0,t.resizeWithoutConstraints(168,40),i.appendChild(t)}else i.children[0]&&(i.children[0].characters=a.c[e.payload]);n[r.id]={name:e.payload,frameId:i.id},t.appendChild(i)}),figma.currentPage.setPluginData("statuses",JSON.stringify(n))}))}(e);case"add-story":return function(e){const t=s(i).concat({id:Math.random().toString(32),content:e.payload.content,isDone:!1});figma.currentPage.setPluginData(`stories.${e.payload.frameId}`,JSON.stringify(t)),figma.ui.postMessage({type:"update-stories",payload:t})}(e);case"toggle-story":return function(e){const t=s(i).map(t=>t.id===e.payload.id?Object.assign(Object.assign({},t),{isDone:!t.isDone}):t);figma.currentPage.setPluginData(`stories.${e.payload.frameId}`,JSON.stringify(t)),figma.ui.postMessage({type:"update-stories",payload:t})}(e);case"remove-story":return function(e){const t=s(i),n=t.findIndex(t=>t.id===e.payload.id);n>=0&&(t.splice(n,1),figma.currentPage.setPluginData(`stories.${e.payload.frameId}`,JSON.stringify(t)),figma.ui.postMessage({type:"update-stories",payload:t}))}(e)}}}});